#! /bin/bash

PROP_URL_LIST="../common.txt lockss.txt lockss.opt"

# local copy of lockss jars allows recompile while we're running
mkdir -p lib
cp ${PROJECT_DIR}/lib/lockss.jar lib
cp ${PROJECT_DIR}/lib/lockss-test.jar lib
CLASSPATH=lib/lockss.jar:lib/lockss-test.jar:`cat ${PROJECT_DIR}/test/test-classpath`
export CLASSPATH

echo running at `date`
#echo CLASSPATH=$CLASSPATH
# for large caches, need to pass "-ms4m -mx64m" to java
#java org.lockss.app.LockssDaemon ${PROP_URL_LIST} >>test.out 2>&1 &
java -Dorg.lockss.defaultLogLevel=DEBUG "$@" RunDaemon ${PROP_URL_LIST} >>test.out 2>&1 &
echo $! >dpid
wait
echo stopped with status $? at `date`
